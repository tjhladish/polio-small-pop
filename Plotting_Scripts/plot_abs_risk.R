dir = '/Users/Celeste/Desktop/polio-small-pop/polio-small-pop/'
require(RColorBrewer)

absRiskMat_5000 = read.csv(file=paste0(dir,'absolute_risk_matrix_N_5000.csv'),header=FALSE)
absRiskMat_10000 = read.csv(file=paste0(dir,'absolute_risk_matrix_N_10000.csv'),header=FALSE)
absRiskMat_15000 = read.csv(file=paste0(dir,'absolute_risk_matrix_N_15000.csv'),header=FALSE)
absRiskMat_20000 = read.csv(file=paste0(dir,'absolute_risk_matrix_N_20000.csv'),header=FALSE)
absRiskMat_25000 = read.csv(file=paste0(dir,'absolute_risk_matrix_N_25000.csv'),header=FALSE)

filter_5000_no_pcase = read.table(paste0(dir,'e_and_d_values-0pcase_filter_det_1_N_5000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_5000_1_pcase = read.table(paste0(dir,'e_and_d_values-1pcase_filter_det_1_N_5000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_10000_no_pcase = read.table(paste0(dir,'e_and_d_values-0pcase_filter_det_1_N_10000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_10000_1_pcase = read.table(paste0(dir,'e_and_d_values-1pcase_filter_det_1_N_10000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_15000_no_pcase = read.table(paste0(dir,'e_and_d_value-0pcase_det_1_N_15000_beta_135_fast_migrate_0_EE_starting_cond_response_paper.out'), col.names=c('time', 'E&D'))
filter_15000_1_pcase = read.table(paste0(dir,'e_and_d_value-1pcase_det_1_N_15000_beta_135_fast_migrate_0_EE_starting_cond_response_paper.out'), col.names=c('time', 'E&D'))
filter_20000_no_pcase = read.table(paste0(dir,'e_and_d_values-0pcase_filter_det_1_N_20000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_20000_1_pcase = read.table(paste0(dir,'e_and_d_values-1pcase_filter_det_1_N_20000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_25000_no_pcase = read.table(paste0(dir,'e_and_d_values-0pcase_filter_det_1_N_25000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))
filter_25000_1_pcase = read.table(paste0(dir,'e_and_d_values-1pcase_filter_det_1_N_25000_beta_135_fast_response_paper.out'), col.names=c('time', 'E&D'))



marker = list(color = brewer.pal(8,"GnBu"))
png(paste0(dir,'abs_risk_pop_size_response_paper.png'), width=1200, height=800, res=150)
plot(absRiskMat_5000,type='l',col=marker$color[4],xlab="Years since paralytic case",ylab="Absolute risk of circulation")
lines(absRiskMat_10000,col=marker$color[5])
lines(absRiskMat_15000,col=marker$color[6])
lines(absRiskMat_20000,col=marker$color[7])
lines(absRiskMat_25000,col=marker$color[8])
legend('topright',legend=c('N=5000','N=10000','N=15000','N=20000','N=25000'),col=marker$color[4:8],lwd=2,bty='n')
dev.off()

#par(mfrow=c(2,1),oma=c(3,3,0,0),mar=c(1,0,0,0),mgp=c(2,1,0))
#layout(matrix(c(1,1,2,2),nrow=2,byrow=TRUE))
png(paste0(dir,'ICA_vs_Non_ICA_pop_size.png'), width=1200, height=800, res=150)
par(mfrow=c(2,1),mar=c(0,3,0,0),oma=c(3,3,1,1),mgp=c(2,1,0))
plot(filter_5000_no_pcase, type='l',lty=1, col = marker$color[4],xlab = '',ylab = 'Probability of circulation',xlim=c(0,5),xaxt='n')
lines(filter_10000_no_pcase,col=marker$color[5],lty=1)
lines(filter_15000_no_pcase,col=marker$color[6],lty=1)
lines(filter_20000_no_pcase,col=marker$color[7],lty=1)
lines(filter_25000_no_pcase,col=marker$color[8],lty=1)
legend('topright',legend=c('N=5000','N=10000','N=15000','N=20000','N=25000'),col=marker$color[4:8],lwd=2,bty='n')
plot(absRiskMat_5000[1:(nrow(absRiskMat_5000)-3),],type='l',col=marker$color[4],xlab="Time since last paralytic case (years)",ylab="Absolute risk of circulation")
lines(absRiskMat_10000[1:(nrow(absRiskMat_10000)-6),],col=marker$color[5])
lines(absRiskMat_15000[1:(nrow(absRiskMat_15000)-1),],col=marker$color[6])
lines(absRiskMat_20000[1:(nrow(absRiskMat_20000)-4),],col=marker$color[7])
lines(absRiskMat_25000[1:(nrow(absRiskMat_5000)-1),],col=marker$color[8])
abline(0,0)
legend('topright',legend=c('N=5000','N=10000','N=15000','N=20000','N=25000'),col=marker$color[4:8],lwd=2,bty='n')
mtext("Time since last paralytic case (years)",side=1,line=2)
dev.off()
